{"ast":null,"code":"var _jsxFileName = \"/Users/alf/DAO-Interface/src/pages/DAO.js\",\n    _s = $RefreshSig$();\n\nimport React, { useContext, useEffect, useState } from 'react';\nimport { ethers } from 'ethers';\nimport { AppContext } from '../context/AppContext';\nimport OracleABI from '../utils/abis/Oracle_ABI.json';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst contractAddresses = {\n  '61': '0x02f3A4bB77fF782A1F9ADeBF392D36390b10fd47',\n  // BSC Testnet\n  '1ba5': '0xE62a3277429B9F26C466D31157D50CaE97561e7C',\n  // Planq Testnet\n  '8274f': '0x730de67Bf353F8d9B2648Cf0af9681b265f06b3A' // Scroll Testnet\n\n};\nconst tickers = {\n  '61': 'TBNB',\n  '1ba5': 'TPLANQ',\n  '8274f': 'ETH'\n};\n\nconst DAO = () => {\n  _s();\n\n  const {\n    currentAccount,\n    networkProvider\n  } = useContext(AppContext);\n  const [daoContract, setDaoContract] = useState(null);\n  const [members, setMembers] = useState([]);\n  const [stakedAmount, setStakedAmount] = useState('0');\n  const [additionalStake, setAdditionalStake] = useState('');\n  const [withdrawAmount, setWithdrawAmount] = useState('');\n  const [totalProposalFees, setTotalProposalFees] = useState('0');\n  const [totalRequestFees, setTotalRequestFees] = useState('0');\n  const [ticker, setTicker] = useState('');\n  useEffect(() => {\n    if (networkProvider) {\n      networkProvider.getNetwork().then(network => {\n        const hexChainId = network.chainId.toString(16);\n        setTicker(tickers[hexChainId] || 'Unknown');\n        const contractAddress = contractAddresses[hexChainId];\n\n        if (contractAddress && currentAccount) {\n          const signer = networkProvider.getSigner();\n          const contract = new ethers.Contract(contractAddress, OracleABI, signer);\n          setDaoContract(contract);\n          fetchStakedAmount(contract, currentAccount);\n          fetchFees(contract);\n          fetchMembers(contract);\n        }\n      });\n    }\n  }, [networkProvider, currentAccount]);\n\n  const fetchMembers = async contract => {\n    const memberCount = 100; // Assuming a max of 100 members for iteration\n\n    const memberAddresses = [];\n\n    for (let i = 0; i < memberCount; i++) {\n      try {\n        const member = await contract.getMember(i);\n        memberAddresses.push(member);\n      } catch (error) {\n        console.error('Failed to fetch member:', error);\n        break; // Break the loop if an error occurs (e.g., out of bounds)\n      }\n    }\n\n    setMembers(memberAddresses);\n  };\n\n  const fetchStakedAmount = async (contract, account) => {\n    try {\n      const amount = await contract.stakes(account);\n      setStakedAmount(ethers.utils.formatEther(amount));\n    } catch (error) {\n      console.error('Failed to fetch staked amount:', error);\n    }\n  };\n\n  const fetchFees = async contract => {\n    try {\n      const proposalFees = await contract.totalProposalFeesCollected();\n      const requestFees = await contract.totalRequestFeesCollected();\n      setTotalProposalFees(ethers.utils.formatEther(proposalFees));\n      setTotalRequestFees(ethers.utils.formatEther(requestFees));\n    } catch (error) {\n      console.error('Failed to fetch fees:', error);\n    }\n  };\n\n  const joinDAO = async () => {\n    if (!daoContract) return;\n\n    try {\n      const txResponse = await daoContract.joinDAO({\n        value: ethers.utils.parseEther(\"10\")\n      });\n      await txResponse.wait();\n      alert('Successfully joined DAO!');\n      fetchStakedAmount(daoContract, currentAccount);\n      fetchFees(daoContract);\n    } catch (error) {\n      console.error('Failed to join DAO:', error);\n      alert('Error joining DAO');\n    }\n  };\n\n  const addStake = async () => {\n    if (!daoContract || !additionalStake) return;\n\n    try {\n      const txResponse = await daoContract.addStake({\n        value: ethers.utils.parseEther(additionalStake)\n      });\n      await txResponse.wait();\n      alert('Successfully added stake!');\n      fetchStakedAmount(daoContract, currentAccount);\n      fetchFees(daoContract);\n      setAdditionalStake('');\n    } catch (error) {\n      console.error('Failed to add stake:', error);\n      alert('Error adding stake');\n    }\n  };\n\n  const withdrawStake = async () => {\n    if (!daoContract || !withdrawAmount) return;\n\n    try {\n      const txResponse = await daoContract.leaveDAO(ethers.utils.parseEther(withdrawAmount));\n      await txResponse.wait();\n      alert('Successfully withdrawn stake!');\n      fetchStakedAmount(daoContract, currentAccount);\n      setWithdrawAmount('');\n    } catch (error) {\n      console.error('Failed to withdraw stake:', error);\n      alert('Error withdrawing stake');\n    }\n  };\n\n  const cardStyle = {\n    backgroundColor: '#1a202c',\n    color: 'white',\n    padding: '20px',\n    borderRadius: '8px',\n    marginBottom: '10px',\n    flex: '1 1 calc(33.333% - 20px)',\n    margin: '10px'\n  };\n  const headerStyle = {\n    display: 'flex',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    marginBottom: '20px',\n    color: 'white'\n  };\n  const buttonStyle = {\n    padding: '10px 20px',\n    borderRadius: '8px',\n    border: 'none',\n    backgroundColor: '#4CAF50',\n    color: 'white',\n    cursor: 'pointer'\n  };\n  const inputStyle = {\n    flex: '1',\n    marginRight: '10px',\n    padding: '10px',\n    borderRadius: '8px',\n    border: '1px solid #ccc'\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      style: headerStyle,\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        style: {\n          color: 'white'\n        },\n        children: \"DAO\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 163,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: joinDAO,\n        style: buttonStyle,\n        children: \"Join DAO\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: cardStyle,\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"DAO Members\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 167,\n        columnNumber: 17\n      }, this), members.length > 0 ? /*#__PURE__*/_jsxDEV(\"ul\", {\n        children: members.map((member, index) => /*#__PURE__*/_jsxDEV(\"li\", {\n          children: member\n        }, index, false, {\n          fileName: _jsxFileName,\n          lineNumber: 171,\n          columnNumber: 29\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 169,\n        columnNumber: 21\n      }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"No members found\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 175,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: cardStyle,\n      children: /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"Staked Amount: \", stakedAmount, \" \", ticker]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 179,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: cardStyle,\n      children: /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"Total Proposal Fees Collected: \", totalProposalFees, \" \", ticker]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 182,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: cardStyle,\n      children: /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"Total Request Fees Collected: \", totalRequestFees, \" \", ticker]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 185,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 184,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: cardStyle,\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        value: additionalStake,\n        onChange: e => setAdditionalStake(e.target.value),\n        placeholder: `Amount to stake (${ticker})`,\n        style: inputStyle\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 188,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: addStake,\n        style: buttonStyle,\n        children: \"Add Stake\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 195,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: cardStyle,\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        value: withdrawAmount,\n        onChange: e => setWithdrawAmount(e.target.value),\n        placeholder: `Amount to unstake (${ticker})`,\n        style: inputStyle\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 198,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: withdrawStake,\n        style: buttonStyle,\n        children: \"Withdraw Stake\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 205,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 197,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 161,\n    columnNumber: 9\n  }, this);\n};\n\n_s(DAO, \"SDHqD1mdU5b+Mft2ImvCw4+3Blo=\");\n\n_c = DAO;\nexport default DAO;\n\nvar _c;\n\n$RefreshReg$(_c, \"DAO\");","map":{"version":3,"sources":["/Users/alf/DAO-Interface/src/pages/DAO.js"],"names":["React","useContext","useEffect","useState","ethers","AppContext","OracleABI","contractAddresses","tickers","DAO","currentAccount","networkProvider","daoContract","setDaoContract","members","setMembers","stakedAmount","setStakedAmount","additionalStake","setAdditionalStake","withdrawAmount","setWithdrawAmount","totalProposalFees","setTotalProposalFees","totalRequestFees","setTotalRequestFees","ticker","setTicker","getNetwork","then","network","hexChainId","chainId","toString","contractAddress","signer","getSigner","contract","Contract","fetchStakedAmount","fetchFees","fetchMembers","memberCount","memberAddresses","i","member","getMember","push","error","console","account","amount","stakes","utils","formatEther","proposalFees","totalProposalFeesCollected","requestFees","totalRequestFeesCollected","joinDAO","txResponse","value","parseEther","wait","alert","addStake","withdrawStake","leaveDAO","cardStyle","backgroundColor","color","padding","borderRadius","marginBottom","flex","margin","headerStyle","display","justifyContent","alignItems","buttonStyle","border","cursor","inputStyle","marginRight","length","map","index","e","target"],"mappings":"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","sourcesContent":["import React, { useContext, useEffect, useState } from 'react';\nimport { ethers } from 'ethers';\nimport { AppContext } from '../context/AppContext';\nimport OracleABI from '../utils/abis/Oracle_ABI.json';\n\nconst contractAddresses = {\n    '61': '0x02f3A4bB77fF782A1F9ADeBF392D36390b10fd47',   // BSC Testnet\n    '1ba5': '0xE62a3277429B9F26C466D31157D50CaE97561e7C', // Planq Testnet\n    '8274f': '0x730de67Bf353F8d9B2648Cf0af9681b265f06b3A' // Scroll Testnet\n};\n  \nconst tickers = {\n    '61': 'TBNB',     \n    '1ba5': 'TPLANQ',\n    '8274f': 'ETH',\n};\n\nconst DAO = () => {\n    const { currentAccount, networkProvider } = useContext(AppContext);\n    const [daoContract, setDaoContract] = useState(null);\n    const [members, setMembers] = useState([]);\n    const [stakedAmount, setStakedAmount] = useState('0');\n    const [additionalStake, setAdditionalStake] = useState('');\n    const [withdrawAmount, setWithdrawAmount] = useState('');\n    const [totalProposalFees, setTotalProposalFees] = useState('0');\n    const [totalRequestFees, setTotalRequestFees] = useState('0');\n    const [ticker, setTicker] = useState('');\n\n    useEffect(() => {\n        if (networkProvider) {\n            networkProvider.getNetwork().then((network) => {\n                const hexChainId = network.chainId.toString(16);\n                setTicker(tickers[hexChainId] || 'Unknown');\n                const contractAddress = contractAddresses[hexChainId];\n                if (contractAddress && currentAccount) {\n                    const signer = networkProvider.getSigner();\n                    const contract = new ethers.Contract(contractAddress, OracleABI, signer);\n                    setDaoContract(contract);\n                    fetchStakedAmount(contract, currentAccount);\n                    fetchFees(contract);\n                    fetchMembers(contract);\n                }\n            });\n        }\n    }, [networkProvider, currentAccount]);\n\n    const fetchMembers = async (contract) => {\n        const memberCount = 100; // Assuming a max of 100 members for iteration\n        const memberAddresses = [];\n        for (let i = 0; i < memberCount; i++) {\n            try {\n                const member = await contract.getMember(i);\n                memberAddresses.push(member);\n            } catch (error) {\n                console.error('Failed to fetch member:', error);\n                break; // Break the loop if an error occurs (e.g., out of bounds)\n            }\n        }\n        setMembers(memberAddresses);\n    };\n\n    const fetchStakedAmount = async (contract, account) => {\n        try {\n            const amount = await contract.stakes(account);\n            setStakedAmount(ethers.utils.formatEther(amount));\n        } catch (error) {\n            console.error('Failed to fetch staked amount:', error);\n        }\n    };\n\n    const fetchFees = async (contract) => {\n        try {\n            const proposalFees = await contract.totalProposalFeesCollected();\n            const requestFees = await contract.totalRequestFeesCollected();\n            setTotalProposalFees(ethers.utils.formatEther(proposalFees));\n            setTotalRequestFees(ethers.utils.formatEther(requestFees));\n        } catch (error) {\n            console.error('Failed to fetch fees:', error);\n        }\n    };\n\n    const joinDAO = async () => {\n        if (!daoContract) return;\n        try {\n            const txResponse = await daoContract.joinDAO({ value: ethers.utils.parseEther(\"10\") });\n            await txResponse.wait();\n            alert('Successfully joined DAO!');\n            fetchStakedAmount(daoContract, currentAccount);\n            fetchFees(daoContract);\n        } catch (error) {\n            console.error('Failed to join DAO:', error);\n            alert('Error joining DAO');\n        }\n    };\n\n    const addStake = async () => {\n        if (!daoContract || !additionalStake) return;\n        try {\n            const txResponse = await daoContract.addStake({ value: ethers.utils.parseEther(additionalStake) });\n            await txResponse.wait();\n            alert('Successfully added stake!');\n            fetchStakedAmount(daoContract, currentAccount);\n            fetchFees(daoContract);\n            setAdditionalStake('');\n        } catch (error) {\n            console.error('Failed to add stake:', error);\n            alert('Error adding stake');\n        }\n    };\n\n    const withdrawStake = async () => {\n        if (!daoContract || !withdrawAmount) return;\n        try {\n            const txResponse = await daoContract.leaveDAO(ethers.utils.parseEther(withdrawAmount));\n            await txResponse.wait();\n            alert('Successfully withdrawn stake!');\n            fetchStakedAmount(daoContract, currentAccount);\n            setWithdrawAmount('');\n        } catch (error) {\n            console.error('Failed to withdraw stake:', error);\n            alert('Error withdrawing stake');\n        }\n    };\n\n    const cardStyle = {\n        backgroundColor: '#1a202c',\n        color: 'white',\n        padding: '20px',\n        borderRadius: '8px',\n        marginBottom: '10px',\n        flex: '1 1 calc(33.333% - 20px)',\n        margin: '10px',\n    };\n\n    const headerStyle = {\n        display: 'flex',\n        justifyContent: 'space-between',\n        alignItems: 'center',\n        marginBottom: '20px',\n        color: 'white'\n    };\n\n    const buttonStyle = {\n        padding: '10px 20px',\n        borderRadius: '8px',\n        border: 'none',\n        backgroundColor: '#4CAF50',\n        color: 'white',\n        cursor: 'pointer'\n    };\n\n    const inputStyle = {\n        flex: '1',\n        marginRight: '10px',\n        padding: '10px',\n        borderRadius: '8px',\n        border: '1px solid #ccc'\n    };\n\n    return (\n        <div>\n            <div style={headerStyle}>\n                <h1 style={{ color: 'white' }}>DAO</h1>\n                <button onClick={joinDAO} style={buttonStyle}>Join DAO</button>\n            </div>\n            <div style={cardStyle}>\n                <h3>DAO Members</h3>\n                {members.length > 0 ? (\n                    <ul>\n                        {members.map((member, index) => (\n                            <li key={index}>{member}</li>\n                        ))}\n                    </ul>\n                ) : (\n                    <p>No members found</p>\n                )}\n            </div>\n            <div style={cardStyle}>\n                <p>Staked Amount: {stakedAmount} {ticker}</p>\n            </div>\n            <div style={cardStyle}>\n                <p>Total Proposal Fees Collected: {totalProposalFees} {ticker}</p>\n            </div>\n            <div style={cardStyle}>\n                <p>Total Request Fees Collected: {totalRequestFees} {ticker}</p>\n            </div>\n            <div style={cardStyle}>\n                <input\n                    type=\"text\"\n                    value={additionalStake}\n                    onChange={e => setAdditionalStake(e.target.value)}\n                    placeholder={`Amount to stake (${ticker})`}\n                    style={inputStyle}\n                />\n                <button onClick={addStake} style={buttonStyle}>Add Stake</button>\n            </div>\n            <div style={cardStyle}>\n                <input\n                    type=\"text\"\n                    value={withdrawAmount}\n                    onChange={e => setWithdrawAmount(e.target.value)}\n                    placeholder={`Amount to unstake (${ticker})`}\n                    style={inputStyle}\n                />\n                <button onClick={withdrawStake} style={buttonStyle}>Withdraw Stake</button>\n            </div>\n        </div>\n    );\n};\n\nexport default DAO;\n"]},"metadata":{},"sourceType":"module"}